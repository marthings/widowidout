<%= turbo_stream_from counter, class: "contents" %>

<div style="--color: <%= counter.color %>" data-controller="scale confetti" id="<%= dom_id counter %>" class="aspect-[4/3] counter-card text-center p-6 md:p-8 relative rounded-xl flex flex-col flex-1 gap-4 items-stretch justify-center">
  
  <%= link_to edit_counter_path(counter), class:"absolute top-4 right-4" do %>
    <%= heroicon "pencil", class: "text-gray-500", variant: "solid", aria: { label: "user-icon" } %>
  <% end %>

  <div class="text-5xl md:text-8xl"><%= counter.emoji %></div>
  
  <h2 class="font-bold text-2xl">
    <%= counter.title %>
  </h2>

  <div class="flex justify-center items-center flex-1">

    <div class="amount font-bold text-6xl md:text-8xl" data-scale-target="amount" data-confetti-target="amount">
      <%= counter.amount %>
    </div>

    <div class="invisible" data-confetti-target="goal" data-goal="<%= counter.goal %>"></div>
    
    <% if counter.goal.positive? && counter.goal > counter.amount %>
      <div class="text-xl font-bold">/ <%= counter.goal %></div>
    <% end %>

  </div>

  <div class="flex flex-col flex-col-reverse mt-auto md:flex-row gap-2 md-gap-4 items-center">

    <%= form_with url: decrement_counter_path(counter), data: { turbo_action: "replace" }, method: :patch, class: "flex gap-4 items-center", html: { class: "contents" } do |form| %>
      <%= form.button class: "cursor-pointer counter-decrement-button w-full rounded-full py-3 px-5 relative active:top-1 active:scale-95", data: { action: "click->scale#scaleDown" } do %>
        <%= heroicon "minus", class: "text-gray-900 mx-auto", variant: "solid", aria: { label: "Decrease counter" } %>
      <% end %>
    <% end %>

    <%= form_with url: increment_counter_path(counter), data: { turbo_action: "replace" }, method: :patch, class: "flex gap-4 items-center", html: { class: "contents" } do |form| %>
      <%= form.button class: "cursor-pointer counter-increment-button w-full rounded-full py-3 px-5 relative active:-top-1 active:scale-105", data: { action: "click->scale#scaleUp click->confetti#checkConfetti" } do %>
        <%= heroicon "plus", class: "text-gray-100 mx-auto", variant: "solid", aria: { label: "Increase counter" } %>
      <% end %>
    <% end %>

  </div>

</div>
